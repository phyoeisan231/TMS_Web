<section class="content mt-0">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12 ">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a routerLink="/dashboard" routerLinkActive="active"><i class="nav-icon fas fa-tachometer-alt"></i>&nbsp;Dashboard</a></li>
          <li class="breadcrumb-item">In Check</li>
          <li class="breadcrumb-item active text-primary">In Check(ICD/Other)</li>
        </ol>
      </div>
    </div>
    <div class="row">
      <div class="card card-primary card-outline">
        <div class="card-body">
          <form [formGroup]="detailForm">
            <div class="row">
              <div class="col-md-6 col-lg-6 text-left">
                <h5 class="card-title">In Check(ICD/Other)</h5>
              </div>
              <div class="col-md-6 col-lg-6 text-end">
                <button *ngIf="!this.id" type="submit" class="btn btn-sm btn-primary mr-2 " [disabled]="!detailForm.valid"  (click)="onFormSubmit()"><i class="fa fa-save"></i>  &nbsp;Save</button>
                <a  class="btn btn-sm btn-secondary m-1"  href="/tms-operation/in-check">
                  <i class="fa fa-arrow-circle-left"></i> &nbsp; Back
                </a>
              </div>
            </div><br>
            <div class="row">
              <div class="form-group col-md-4">
                <label  class="font-weight-normal requiredfield">Yard</label>
                <ejs-textbox *ngIf="this.id" formControlName="inYardID" [readonly]="true" tabindex="1" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id" formControlName="inYardID" tabindex="1" [dataSource]='yardList' [fields]="{ text: 'yardID', value: 'yardID' }" (change)="onYardChange($event.value)" placeholder="Select One"  popupHeight='200px' ></ejs-dropdownlist>
                <div [style.visibility]='validateControl("inYardID")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Yard is required</label>
                </div>
              </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal requiredfield">Gate</label>
                <ejs-textbox *ngIf="this.id" formControlName="inGateID" [readonly]="true" tabindex="2" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id"  formControlName="inGateID" tabindex="2" [dataSource]='gateList' [fields]="{ text: 'gateID', value: 'gateID' }"  popupHeight='200px' placeholder="Select One" ></ejs-dropdownlist>
                <div [style.visibility]='validateControl("inGateID")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Gate is required</label>
                </div>
              </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal requiredfield">Category</label>
                <ejs-textbox *ngIf="this.id" formControlName="inPCCode" [readonly]="true" tabindex="3" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id" formControlName="inPCCode" tabindex="3" [dataSource]='pcCodeList' [fields]="{ text: 'pcCode', value: 'pcCode' }" allowFiltering="true" (change)="onCategoryChange($event.value)" placeholder="Select One"></ejs-dropdownlist>
                <div [style.visibility]='validateControl("inPCCode")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Category is required</label>
                </div>
            </div>
            </div>
            <div class="row">
              <div class="form-group col-md-4">
                <label  class="font-weight-normal requiredfield">Operation Area</label>
                <ejs-textbox *ngIf="this.id" formControlName="areaID" [readonly]="true" tabindex="4" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id" formControlName="areaID" tabindex="4" [dataSource]='areaList' [fields]="{ text: 'areaID', value: 'areaID' }" placeholder="Select One" ></ejs-dropdownlist>
                <div [style.visibility]='validateControl("areaID")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Operation Area is required</label>
                </div>
              </div>
              <div class="form-group col-md-4">
                <label class="font-weight-normal requiredfield">Check Date Time</label>
                <ejs-timepicker  formControlName="inCheckDateTime" [format]="format" [step]="interval" autocomplete="off" tabindex="5" [readonly]="this.id"></ejs-timepicker>
                <div [style.visibility]='validateControl("inCheckDateTime")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Check Date Time is required</label>
                </div>
               </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal requiredfield">Truck Type</label>
                <ejs-textbox *ngIf="this.id" formControlName="truckType" [readonly]="true" tabindex="6" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id"  formControlName="truckType" tabindex="6" placeholder="Select One" [dataSource]='truckTypeList'  (change)="onTruckTypeChange($event.value)"></ejs-dropdownlist>
                <div [style.visibility]='validateControl("truckType")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Truck Type is required</label>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="form-group col-md-4">
                <label  class="font-weight-normal requiredfield">Truck No</label>
                <ejs-textbox *ngIf="this.id" formControlName="truckVehicleRegNo" [readonly]="true" tabindex="7" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id" formControlName="truckVehicleRegNo" tabindex="7" placeholder="Enter some keys" [dataSource]='truckList' [fields]="{ text: 'vehicleRegNo', value: 'vehicleRegNo' }" (change)="onTruckChange($event.value)" allowFiltering="true" (filtering)='onTruckFiltering($event)'></ejs-dropdownlist>
                <div [style.visibility]='validateControl("truckVehicleRegNo")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Truck No is required</label>
                </div>
              </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal">Trailer No</label>
                <ejs-textbox *ngIf="this.id" formControlName="trailerVehicleRegNo" [readonly]="true" tabindex="8" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id" formControlName="trailerVehicleRegNo" tabindex="8" [dataSource]='trailerList' [fields]="{ text: 'vehicleRegNo', value: 'vehicleRegNo' }" placeholder="Select One" allowFiltering="true" popupHeight='200px'></ejs-dropdownlist>
              </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal requiredfield">Driver Name</label>
                <ejs-textbox *ngIf="this.id" formControlName="driverLicenseNo" [readonly]="true" tabindex="9" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id"  formControlName="driverLicenseNo" tabindex="9" [dataSource]='driverList' placeholder="Enter some keys" [fields]="{ text: 'driverName', value: 'licenseNo' }" allowFiltering="true" (filtering)='onDriverFiltering($event)' popupHeight='200px'></ejs-dropdownlist>
                <div [style.visibility]='validateControl("driverLicenseNo")? "visible": "hidden"'>
                  <label class="e-error" style="display: block;">*Driver Name is required</label>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="form-group col-md-4">
                <label  class="font-weight-normal">Type</label>
                <ejs-textbox *ngIf="this.id" formControlName="inType" [readonly]="true" tabindex="10" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id" formControlName="inType" tabindex="10" [dataSource]='typeList'  placeholder="Select One" ></ejs-dropdownlist>
              </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal">Cargo Type</label>
                <ejs-textbox *ngIf="this.id" formControlName="inCargoType" [readonly]="true" tabindex="11" ></ejs-textbox>
                <ejs-dropdownlist *ngIf="!this.id" formControlName="inCargoType" tabindex="11" [dataSource]='cargoTypeList'  placeholder="Select One" ></ejs-dropdownlist>
              </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal">CargoInfo</label>
                <ejs-textbox formControlName="inCargoInfo" [multiline]="true" tabindex="12" [readonly]="this.id"></ejs-textbox>
              </div>
            </div>
            <div class="row">
              <div class="form-group col-md-4">
                <label  class="font-weight-normal">Customer</label>
                <ejs-textbox formControlName="customer" [multiline]="true" tabindex="13" [readonly]="this.id"></ejs-textbox>
              </div>
              <div class="form-group col-md-4">
                <label  class="font-weight-normal">Remark</label>
                <ejs-textbox formControlName="remark" [multiline]="true" tabindex="14" [readonly]="this.id"></ejs-textbox>
              </div>
              <div class="form-group col-lg-2 col-md-2"><br>
                <ejs-checkbox formControlName="inboundWeight"  label="In Weight?"  autocomplete="off" floatLabelType="Always" tabindex="15" [disabled]="this.type=='RG'"></ejs-checkbox>
              </div>
              <div class="form-group col-lg-2 col-md-2"><br>
                <ejs-checkbox formControlName="outboundWeight"  label="Out Weight?"  autocomplete="off" floatLabelType="Always" tabindex="16" [disabled]="this.type=='RG'"></ejs-checkbox>
              </div>
            </div>
          </form><br>
          <h6>Documents</h6>
          <ejs-grid #Grid [dataSource]="docList" [allowSorting]="true" [allowPaging]="true"  [pageSettings]='pageSettings'  [editSettings]="editSettings" [toolbar]="toolbar" (toolbarClick)='toolbarClick($event)' [gridLines]="lines" (rowDataBound)='rowDataBound($event)'>
            <e-columns>
              <e-column type='checkbox' width='40' ></e-column>
              <e-column field='docCode' headerText="Doc No" width="100"></e-column>
              <e-column field='docName' headerText="Name" width="110"></e-column>
              <e-column field='checkStatus' headerText="Check Status" width="120"></e-column>
            </e-columns>
          </ejs-grid>
        </div>
      </div>
   </div>
 </div>
 <ejs-dialog #cardModel isModal="true"  [showCloseIcon]="true" height="55%" width="400px"  allowDragging="true" [visible]="false">
  <ng-template #header>
    <div class="font-weight-bold">Assign Card Form</div>
  </ng-template>
  <form [formGroup]="cardForm">
  <div class="row">
    <div class="form-group col-md-12">
      <label  class="requiredfield">Card</label>
      <ejs-dropdownlist formControlName="cardNo" tabindex="1" [dataSource]='cardList' [fields]="{ text: 'cardNo', value: 'cardNo' }" [allowFiltering]="true" placeholder="Select One" ></ejs-dropdownlist>
    </div>
   </div>
   <div class="row">
    <div class="form-group col-md-6" *ngIf="this.isInWb">
      <label  class="requiredfield">In Weight Bridge</label>
      <ejs-dropdownlist formControlName="inWeightBridgeID" tabindex="2" [dataSource]='wbList' [fields]="{ text: 'weightBridgeID', value: 'weightBridgeID' }" [allowFiltering]="true" placeholder="Select One" ></ejs-dropdownlist>
    </div>
    <div class="form-group col-md-6" *ngIf="this.isOutWb">
      <label  class="requiredfield">Out Weight Bridge</label>
      <ejs-dropdownlist formControlName="outWeightBridgeID" tabindex="3" [dataSource]='wbList' [fields]="{ text: 'weightBridgeID', value: 'weightBridgeID' }" [allowFiltering]="true" placeholder="Select One" ></ejs-dropdownlist>
    </div>
   </div>
   <div class="row">
    <div class="form-group col-md-6" *ngIf="this.isInWb">
      <label  class="requiredfield">In Weight Bridge Option</label>
      <ejs-dropdownlist formControlName="inWBOption" tabindex="4" [dataSource]='wbOptionList'  placeholder="Select One" ></ejs-dropdownlist>
    </div>
    <div class="form-group col-md-6" *ngIf="this.isOutWb">
      <label  class="requiredfield">Out Weight Bridge Option</label>
      <ejs-dropdownlist formControlName="outWeightBridgeID" tabindex="5" [dataSource]='wbOptionList' placeholder="Select One" ></ejs-dropdownlist>
    </div>
   </div>
    <ng-template #footerTemplate>
      <button  class="e-edit-dialog e-control e-btn e-lib e-primary e-flat" type="submit" [disabled]="!this.cardForm.valid"  ejs-button (click)="onFormAssignCard()">Valid</button>
      <button  class="e-edit-dialog e-control e-btn e-lib e-flat" (click)="cardModel.hide()" ejs-button >Close</button>
    </ng-template>
  </form>
</ejs-dialog>
</section>
<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#fff" type = "square-jelly-box" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>

