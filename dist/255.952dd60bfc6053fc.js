"use strict";(self.webpackChunktms_gate=self.webpackChunktms_gate||[]).push([[255],{8255:(V,g,s)=>{s.r(g),s.d(g,{TruckStatusComponent:()=>L});var i=s(9417),m=s(9437),h=s(7673),C=s(7586),f=s.n(C),D=s(8032),l=s.n(D),w=s(3865),t=s(3953),T=s(1626),p=s(2525);const k={headers:new T.Lr({"Content-Type":"application/json"})};let j=(()=>{class a{constructor(e){this.http=e}getYardList(e){return this.http.get(p.c.url+"Master/GetYardList/?active="+e)}getTruckProcessList(e,o,r,n){return this.http.get(p.c.url+"TMSOperation/GetTruckProcessList/?startDate="+e+"&endDate="+o+"&status="+r+"&yard="+n)}startOperation(e){return this.http.put(p.c.url+"TMSOperation/StartOperation",e,k)}endOperation(e){return this.http.put(p.c.url+"TMSOperation/EndOperation",e,k)}static#t=this.\u0275fac=function(o){return new(o||a)(t.KVO(T.Qq))};static#e=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var v=s(6554),d=s(8578),b=s(4088),S=s(7808),F=s(3924),N=s(6674);const x=["Grid"],E=["startModal"],y=["endModal"],I=()=>({text:"yardID",value:"yardID"});function G(a,u){if(1&a&&(t.j41(0,"div")(1,"span",95),t.EFF(2),t.k0s()()),2&a){const e=u.$implicit,o=t.XpG();t.R7$(),t.xc7("background-color",o.getBadgeColor(null==e?null:e.status)),t.R7$(),t.SpI(" ",(null==e?null:e.truckVehicleRegNo)||"N/A"," ")}}function O(a,u){1&a&&(t.j41(0,"div",96),t.EFF(1,"Operation Start Form"),t.k0s())}function M(a,u){if(1&a){const e=t.RV6();t.j41(0,"button",97),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.onStartOpt())}),t.EFF(1,"Save"),t.k0s(),t.j41(2,"button",98),t.bIt("click",function(){t.eBV(e),t.XpG();const r=t.sdS(117);return t.Njj(r.hide())}),t.EFF(3,"Close"),t.k0s()}if(2&a){const e=t.XpG();t.Y8G("disabled",!e.startForm.valid)}}function R(a,u){1&a&&(t.j41(0,"div",96),t.EFF(1,"Operation End Form"),t.k0s())}function Y(a,u){if(1&a){const e=t.RV6();t.j41(0,"button",97),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.onEndOpt())}),t.EFF(1,"Save"),t.k0s(),t.j41(2,"button",98),t.bIt("click",function(){t.eBV(e),t.XpG();const r=t.sdS(146);return t.Njj(r.hide())}),t.EFF(3,"Close"),t.k0s()}if(2&a){const e=t.XpG();t.Y8G("disabled",!e.endForm.valid)}}let L=(()=>{class a{constructor(e,o){this.service=e,this.spinner=o,this.pageSettings={pageSize:50},this.editSettings={allowEditing:!1,allowAdding:!1,allowDeleting:!0,mode:"Dialog"},this.toolbar=[{text:"Start Operation",tooltipText:"Start Operation",prefixIcon:"e-icons e-circle-add",id:"start"},{text:"End Operation",tooltipText:"End Operation",prefixIcon:"e-icons e-circle-add",id:"end"},"ExcelExport","Search"],this.lines="Both",this.submitClicked=!1,this.formatfilter="MM/dd/yyyy",this.format="dd/MM/yyyy h:mm:ss a",this.interval=1,this.yardList=[],this.endDate=new Date,this.today=new Date,this.statusList=["In(Check)","In","In(Weight)","Operation","Out(Weight)","Out(Check)","Out"],this.placeholder="Select One",this.aggregates=[{columns:[{type:["count"],field:"driverName",columnName:"driverName",footerTemplate:"Total Count: ${count}"}]}]}ngOnInit(){this.mode="CheckBox",this.selectAllText="Select All",this.groupOptions={showDropArea:!1,columns:["groupName"]},this.getLocationList(),this.optionForm=new i.gE({fromDate:new i.MJ(sessionStorage.getItem("tsfromDate")?sessionStorage.getItem("tsfromDate"):this.today,i.k0.required),toDate:new i.MJ(sessionStorage.getItem("tstoDate")?sessionStorage.getItem("tstoDate"):this.today,i.k0.required),yardID:new i.MJ(sessionStorage.getItem("tsloc")?sessionStorage.getItem("tsloc"):null,i.k0.required),status:new i.MJ(sessionStorage.getItem("tstatus")?sessionStorage.getItem("tstatus").split(","):null,i.k0.required)}),this.startForm=new i.gE({inRegNo:new i.MJ("",i.k0.required),optStartDate:new i.MJ(this.today,i.k0.required),grNNo:new i.MJ(""),gdNNo:new i.MJ("")}),this.endForm=new i.gE({inRegNo:new i.MJ("",i.k0.required),optEndDate:new i.MJ(this.today,i.k0.required),grNNo:new i.MJ(""),gdNNo:new i.MJ("")})}getLocationList(){this.spinner.show(),this.service.getYardList("true").pipe((0,m.W)(e=>(0,h.of)(this.showError(e)))).subscribe(e=>{this.yardList=e,this.spinner.hide()})}getBadgeColor(e){switch(e){case"In(Check)":return" rgb(248, 144, 32)";case"In":return" rgb(171, 127, 195)";case"In(Weight)":return"#d83ad8";case"Operation":return"#0dcaf0";case"Out(Weight)":return"rgb(23, 117, 223)";case"Out(Check)":return"rgba(52, 187, 52, 0.8)";case"Out":return"rgb(23, 106, 23)";default:return"rgb(199, 73, 73)"}}loadTableData(){this.spinner.show();const e=this.optionForm.value,o=f()(e.fromDate).format("MM/DD/YYYY"),r=f()(e.toDate).format("MM/DD/YYYY");let n="";e.status?.length>0&&(n=this.formatParams(e.status)),sessionStorage.setItem("tsfromDate",o),sessionStorage.setItem("tstoDate",r),sessionStorage.setItem("tsloc",e.yardID),sessionStorage.setItem("tstatus",e.status),this.service.getTruckProcessList(o,r,n,e.yardID).pipe((0,m.W)(c=>(0,h.of)(this.showError(c)))).subscribe(c=>{this.grid.dataSource=c,this.grid.searchSettings.operator="equal",this.grid.refresh(),this.spinner.hide()})}getTotalCount(){return this.grid?.dataSource?this.grid.dataSource.length:0}formatParams(e){return e.map(o=>`'${o}'`).join(",")}showSuccess(e){this.spinner.hide(),l().fire("Truck status",e,"success")}validateControl(e){const o=this.startForm.get(e);return o.invalid&&(o.dirty||o.touched)||o.invalid&&this.submitClicked}validateEndControl(e){const o=this.endForm.get(e);return o.invalid&&(o.dirty||o.touched)||o.invalid&&this.submitClicked}showError(e){this.spinner.hide(),l().fire("Truck status",e.statusText,"error")}onStartOpt(){const e=localStorage.getItem("currentUser"),o=this.startForm.value;o.updatedUser=e,o.optStartDate=f()(o.optStartDate).format("MM/DD/YYYY HH:mm:ss"),this.spinner.show(),this.service.startOperation(o).pipe((0,m.W)(r=>(0,h.of)(this.showError(r)))).subscribe(r=>{1==r.status?(this.spinner.hide(),this.startModal.hide(),this.loadTableData(),this.showSuccess(r.messageContent)):(this.spinner.hide(),l().fire("Truck status",r.messageContent,"error"))})}onEndOpt(){const e=localStorage.getItem("currentUser"),o=this.endForm.value;o.updatedUser=e,o.optEndDate=f()(o.optEndDate).format("MM/DD/YYYY HH:mm:ss"),this.spinner.show(),this.service.endOperation(o).pipe((0,m.W)(r=>(0,h.of)(this.showError(r)))).subscribe(r=>{1==r.status?(this.spinner.hide(),this.endModal.hide(),this.loadTableData(),this.showSuccess(r.messageContent)):(this.spinner.hide(),l().fire("Truck status",r.messageContent,"error"))})}toolbarClick(e){if("Excel Export"===e.item.text&&this.grid.excelExport({fileName:"TruckStatusReport.xlsx"}),"start"===e.item.id||"end"===e.item.id){let o=this.grid.getSelectedRecords();if(0!=o.length){const r=o[0].inRegNo;return void("start"===e.item.id?"In(Weight)"===o[0].status&&null==o[0].optStartDate?(this.startForm.reset(),this.startForm.controls.inRegNo.setValue(r),this.startForm.controls.optStartDate.setValue(this.today),this.startModal.show()):l().fire("Truck status","Operation can not start!","warning"):null!=o[0].optStartDate&&"In(Weight)"===o[0].status?(this.endForm.reset(),this.endForm.controls.inRegNo.setValue(r),this.endForm.controls.optEndDate.setValue(this.today),this.endForm.controls.grNNo.setValue(o[0].grnNo),this.endForm.controls.gdNNo.setValue(o[0].gdnNo),this.endModal.show()):l().fire("Truck status","Operation can not end!","warning"))}l().fire("Truck status","Please select row!","warning")}}static#t=this.\u0275fac=function(o){return new(o||a)(t.rXU(j),t.rXU(v.ex))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-truck-status"]],viewQuery:function(o,r){if(1&o&&(t.GBs(x,5),t.GBs(E,5),t.GBs(y,5)),2&o){let n;t.mGM(n=t.lsd())&&(r.grid=n.first),t.mGM(n=t.lsd())&&(r.startModal=n.first),t.mGM(n=t.lsd())&&(r.endModal=n.first)}},standalone:!0,features:[t.aNF],decls:177,vars:42,consts:[["Grid",""],["template",""],["startModal",""],["header",""],["footerTemplate",""],["endModal",""],[1,"content","mt-0"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/","routerLinkActive","active"],[1,"nav-icon","fas","fa-tachometer-alt"],[1,"breadcrumb-item","active","text-primary"],[1,"card","card-primary","card-outline"],[1,"card-body"],[1,"col-md-12","col-lg-12","text-left"],[1,"card-title"],[3,"formGroup"],[1,"row","btns","mb-2"],[1,"col-lg-5","col-12"],["for","fromDate",1,"col-sm-4","col-form-label","requiredfield"],[1,"col-sm-8","p-0"],["formControlName","fromDate","floatLabelType","Always",3,"format"],["for","toDate",1,"col-sm-4","col-form-label","requiredfield"],["formControlName","toDate","floatLabelType","Always",3,"format"],[1,"row","mb-2"],[1,"col-sm-4","col-form-label","requiredfield"],["formControlName","yardID","placeholder","Select Yard","tabindex","4",3,"dataSource","fields"],["formControlName","status","placeholder","Select Status","showSelectAll","true","tabindex","5",3,"dataSource","mode","placeholder","selectAllText"],[1,"col-lg-2","col-12","justify-content-end"],["type","button",1,"btn","btn-sm","btn-primary",3,"click","disabled"],[1,"fas","fa-eye"],[1,"total-count",2,"margin-bottom","10px","font-weight","bold"],[3,"toolbarClick","dataSource","allowResizing","allowSorting","allowPaging","allowGrouping","groupSettings","aggregates","pageSettings","editSettings","allowExcelExport","toolbar","gridLines"],["field","truckVehicleRegNo","headerText","Truck No","width","100"],["field","driverName","headerText","Driver Name","width","150"],["field","driverLicenseNo","headerText","Driver License No","width","150"],["field","driverContactNo","headerText","Driver Contact No","width","150"],["field","inPCCode","headerText","In Category","width","100"],["field","groupName","headerText","Group Name","width","150"],["field","cardNo","headerText","Card No","width","100"],["field","customer","headerText","Customer","width","150"],["field","inCheckDateTime","headerText","In Check Date Time","width","150"],["field","inYardID","headerText","Yard","width","100"],["field","inGateID","headerText","Gate","width","100"],["field","areaID","headerText","Area","width","100"],["field","inType","headerText","In Type","width","100"],["field","inCargoType","headerText","In CargoType","width","100"],["field","inCargoInfo","headerText","In Cargo Info","width","100"],["field","truckType","headerText","Truck Type","width","120"],["field","inWeightBridgeID","headerText","In WeightBridge","width","150"],["field","outWeightBridgeID","headerText","Out WeightBridge","width","150"],["field","inPCCode","headerText","Out Category","width","100"],["field","inGatePassTime","headerText","In GatePas Time","width","150"],["field","outCheckDateTime","headerText","Out Check Date Time","width","150"],["field","outCheckDateTime","headerText","Out GatePas Time","width","150"],["field","outGateID","headerText","Out Gate","width","100"],["field","outType","headerText","Out Type","width","100"],["field","outCargoType","headerText","Out CargoType","width","100"],["field","outCargoInfo","headerText","Out Cargo Info","width","100"],["field","status","headerText","Status","width","100"],["field","inWeightDateTime","headerText","In Weight Date Time","width","150"],["field","outWeightDateTime","headerText","Out Weight Date Time","width","150"],["field","optStartDate","headerText","Opt Start Date Time","width","150"],["field","optEndDate","headerText","Opt End Date Time","width","150"],["field","grnNo","headerText","GRN No","width","100"],["field","gdnNo","headerText","GDN No","width","100"],["field","remark","headerText","Remark","width","100"],["field","inRegNo","headerText","In Check No","width","110",3,"isPrimaryKey","visible"],["field","outRegNo","headerText","Out Check No","width","110",3,"visible"],[1,"mt-3"],[1,"mx-3"],[1,"fa","fa-square","font-small-2","mr-1",2,"color","rgb(248, 144, 32)"],[1,"fa","fa-square","font-small-2","mr-1",2,"color","rgb(171, 127, 195)"],[1,"fa","fa-square","text-orchid","font-small-2","mr-1"],[1,"mx-2"],[1,"fa","fa-square","text-info","font-small-2","mr-1"],[1,"fa","fa-square","text-primary","font-small-2","mr-1"],[1,"mx-1"],[1,"fa","fa-square","text-mediumSeaGreen","font-small-2","mr-1"],[1,"fa","fa-square","text-success","font-small-2","mr-1"],["isModal","true","height","55%","width","400px","allowDragging","true",3,"showCloseIcon","visible"],[1,"form-group","col-md-12"],[1,"requiredfield"],["formControlName","inRegNo","tabindex","1","readonly","true"],["formControlName","optStartDate","tabindex","2",3,"format","step"],[1,"e-error",2,"display","block"],[1,"form-group","col-md-6"],["formControlName","grNNo","tabindex","3"],["formControlName","gdNNo","tabindex","4"],["formControlName","optEndDate","tabindex","2",3,"format","step"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","square-jelly-box",3,"fullScreen"],[2,"color","white"],[1,"badge"],[1,"font-weight-bold"],["type","submit","ejs-button","",1,"e-edit-dialog","e-control","e-btn","e-lib","e-primary","e-flat",3,"click","disabled"],["ejs-button","",1,"e-edit-dialog","e-control","e-btn","e-lib","e-flat",3,"click"]],template:function(o,r){if(1&o){const n=t.RV6();t.j41(0,"section",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"ol",10)(5,"li",11)(6,"a",12),t.nrm(7,"i",13),t.EFF(8,"\xa0Dashboard"),t.k0s()(),t.j41(9,"li",14),t.EFF(10,"Truck Status"),t.k0s()()()(),t.j41(11,"div",8)(12,"div",15)(13,"div",16)(14,"div",8)(15,"div",17)(16,"h5",18),t.EFF(17,"Truck Status"),t.k0s(),t.j41(18,"Form",19)(19,"div",20)(20,"div",21)(21,"div",8)(22,"label",22),t.EFF(23,"Date:"),t.k0s(),t.j41(24,"div",23),t.nrm(25,"ejs-datepicker",24),t.k0s()()(),t.j41(26,"div",21)(27,"div",8)(28,"label",25),t.EFF(29,"To:"),t.k0s(),t.j41(30,"div",23),t.nrm(31,"ejs-datepicker",26),t.k0s()()()(),t.j41(32,"div",27)(33,"div",21)(34,"div",8)(35,"label",28),t.EFF(36,"Yard:"),t.k0s(),t.j41(37,"div",23),t.nrm(38,"ejs-dropdownlist",29),t.k0s()()(),t.j41(39,"div",21)(40,"div",8)(41,"label",28),t.EFF(42,"Status:"),t.k0s(),t.j41(43,"div",23),t.nrm(44,"ejs-multiselect",30),t.k0s()()(),t.j41(45,"div",31)(46,"button",32),t.bIt("click",function(){return t.eBV(n),t.Njj(r.loadTableData())}),t.nrm(47,"i",33),t.EFF(48," \xa0 View "),t.k0s()()()()()(),t.j41(49,"div",34),t.EFF(50),t.k0s(),t.j41(51,"ejs-grid",35,0),t.bIt("toolbarClick",function($){return t.eBV(n),t.Njj(r.toolbarClick($))}),t.j41(53,"e-columns")(54,"e-column",36),t.DNE(55,G,3,3,"ng-template",null,1,t.C5r),t.k0s(),t.nrm(57,"e-column",37)(58,"e-column",38)(59,"e-column",39)(60,"e-column",40)(61,"e-column",41)(62,"e-column",42)(63,"e-column",43)(64,"e-column",44)(65,"e-column",45)(66,"e-column",46)(67,"e-column",47)(68,"e-column",48)(69,"e-column",49)(70,"e-column",50)(71,"e-column",51)(72,"e-column",52)(73,"e-column",53)(74,"e-column",54)(75,"e-column",55)(76,"e-column",56)(77,"e-column",57)(78,"e-column",58)(79,"e-column",59)(80,"e-column",60)(81,"e-column",61)(82,"e-column",62)(83,"e-column",63)(84,"e-column",64)(85,"e-column",65)(86,"e-column",66)(87,"e-column",67)(88,"e-column",68)(89,"e-column",69)(90,"e-column",70)(91,"e-column",71),t.k0s()(),t.j41(92,"div",72)(93,"span",73),t.EFF(94,"Status:"),t.k0s(),t.j41(95,"span"),t.nrm(96,"i",74),t.EFF(97," In(Check)"),t.k0s(),t.j41(98,"span",73),t.nrm(99,"i",75),t.EFF(100," In"),t.k0s(),t.j41(101,"span",73),t.nrm(102,"i",76),t.EFF(103," In(Weight)"),t.k0s(),t.j41(104,"span",77),t.nrm(105,"i",78),t.EFF(106," Operation"),t.k0s(),t.j41(107,"span"),t.nrm(108,"i",79),t.EFF(109," Out(Weight)"),t.k0s(),t.j41(110,"span",80),t.nrm(111,"i",81),t.EFF(112," Out(Check)"),t.k0s(),t.j41(113,"span",77),t.nrm(114,"i",82),t.EFF(115," Out"),t.k0s()()()()()(),t.j41(116,"ejs-dialog",83,2),t.DNE(118,O,2,0,"ng-template",null,3,t.C5r),t.j41(120,"form",19)(121,"div",8)(122,"div",84)(123,"label",85),t.EFF(124,"In Check No"),t.k0s(),t.nrm(125,"ejs-textbox",86),t.k0s()(),t.j41(126,"div",8)(127,"div",84)(128,"label",85),t.EFF(129,"Start Time"),t.k0s(),t.nrm(130,"ejs-timepicker",87),t.j41(131,"div")(132,"label",88),t.EFF(133,"*Start Time is required"),t.k0s()()()(),t.j41(134,"div",8)(135,"div",89)(136,"label"),t.EFF(137,"GRN No"),t.k0s(),t.nrm(138,"ejs-numerictextbox",90),t.k0s(),t.j41(139,"div",89)(140,"label"),t.EFF(141,"GDN No"),t.k0s(),t.nrm(142,"ejs-numerictextbox",91),t.k0s()(),t.DNE(143,M,4,1,"ng-template",null,4,t.C5r),t.k0s()(),t.j41(145,"ejs-dialog",83,5),t.DNE(147,R,2,0,"ng-template",null,3,t.C5r),t.j41(149,"form",19)(150,"div",8)(151,"div",84)(152,"label",85),t.EFF(153,"In Check No"),t.k0s(),t.nrm(154,"ejs-textbox",86),t.k0s()(),t.j41(155,"div",8)(156,"div",84)(157,"label",85),t.EFF(158,"End Time"),t.k0s(),t.nrm(159,"ejs-timepicker",92),t.j41(160,"div")(161,"label",88),t.EFF(162,"*End Time is required"),t.k0s()()()(),t.j41(163,"div",8)(164,"div",89)(165,"label"),t.EFF(166,"GRN No"),t.k0s(),t.nrm(167,"ejs-numerictextbox",90),t.k0s(),t.j41(168,"div",89)(169,"label"),t.EFF(170,"GDN No"),t.k0s(),t.nrm(171,"ejs-numerictextbox",91),t.k0s()(),t.DNE(172,Y,4,1,"ng-template",null,4,t.C5r),t.k0s()()(),t.j41(174,"ngx-spinner",93)(175,"p",94),t.EFF(176," Loading... "),t.k0s()()}2&o&&(t.R7$(18),t.Y8G("formGroup",r.optionForm),t.R7$(7),t.Y8G("format",r.formatfilter),t.R7$(6),t.Y8G("format",r.formatfilter),t.R7$(7),t.Y8G("dataSource",r.yardList)("fields",t.lJ4(41,I)),t.R7$(6),t.Y8G("dataSource",r.statusList)("mode",r.mode)("placeholder",r.placeholder)("selectAllText",r.selectAllText),t.R7$(2),t.Y8G("disabled",!r.optionForm.valid),t.R7$(4),t.SpI(" Total Count: ",r.getTotalCount()," "),t.R7$(),t.Y8G("dataSource",r.data)("allowResizing",!0)("allowSorting",!0)("allowPaging",!0)("allowGrouping",!0)("groupSettings",r.groupOptions)("aggregates",r.aggregates)("pageSettings",r.pageSettings)("editSettings",r.editSettings)("allowExcelExport",!0)("toolbar",r.toolbar)("gridLines",r.lines),t.R7$(39),t.Y8G("isPrimaryKey",!0)("visible",!1),t.R7$(),t.Y8G("visible",!1),t.R7$(25),t.Y8G("showCloseIcon",!0)("visible",!1),t.R7$(4),t.Y8G("formGroup",r.startForm),t.R7$(10),t.Y8G("format",r.format)("step",r.interval),t.R7$(),t.xc7("visibility",r.validateControl("optStartDate")?"visible":"hidden"),t.R7$(14),t.Y8G("showCloseIcon",!0)("visible",!1),t.R7$(4),t.Y8G("formGroup",r.endForm),t.R7$(10),t.Y8G("format",r.format)("step",r.interval),t.R7$(),t.xc7("visibility",r.validateEndControl("optEndDate")?"visible":"hidden"),t.R7$(14),t.Y8G("fullScreen",!0))},dependencies:[w.G,i.qT,i.BC,i.cb,i.j4,i.JD,d._ab,d.eeu,d.rFS,d.LGG,d.cvh,b.V9,S.Jh,F.I,S.OV,N.mq,b.b3,F.fl,v.et]})}return a})()}}]);