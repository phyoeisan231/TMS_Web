"use strict";(self.webpackChunktms_gate=self.webpackChunktms_gate||[]).push([[116],{5116:(H,m,a)=>{a.r(m),a.d(m,{ProposalFormComponent:()=>K});var i=a(9417),d=a(9437),p=a(7673),j=a(8032),c=a.n(j),g=a(27),C=a(7586),F=a.n(C),o=a(3953),E=a(3542),h=a(6554),u=a(3782),v=a(177),x=a(4088),f=a(7808),y=a(3924);const I=["Grid"],T=()=>({text:"categoryName",value:"pcCode"}),_=()=>({text:"yardID",value:"yardID"}),b=()=>({text:"areaID",value:"areaID"}),D=()=>({text:"customer",value:"customerId"}),w=()=>({text:"jobCode",value:"jobCode"});function L(r,l){1&r&&(o.j41(0,"h5",47),o.EFF(1,"Add TMS Proposal"),o.k0s())}function P(r,l){1&r&&(o.j41(0,"h5",47),o.EFF(1,"Update TMS Proposal"),o.k0s())}function O(r,l){if(1&r){const e=o.RV6();o.j41(0,"button",48),o.bIt("click",function(){o.eBV(e);const s=o.XpG();return o.Njj(s.onFormSubmit())}),o.nrm(1,"i",49),o.EFF(2," \xa0Update"),o.k0s()}if(2&r){const e=o.XpG();o.Y8G("disabled",!e.proposalForm.valid)}}function N(r,l){if(1&r){const e=o.RV6();o.j41(0,"button",48),o.bIt("click",function(){o.eBV(e);const s=o.XpG();return o.Njj(s.onFormSubmit())}),o.nrm(1,"i",49),o.EFF(2," \xa0Save"),o.k0s()}if(2&r){const e=o.XpG();o.Y8G("disabled",!e.proposalForm.valid)}}function S(r,l){if(1&r&&o.nrm(0,"ejs-dropdownlist",50),2&r){const e=o.XpG();o.Y8G("dataSource",e.yardList)("fields",o.lJ4(2,_))}}function k(r,l){if(1&r){const e=o.RV6();o.j41(0,"ejs-dropdownlist",51),o.bIt("change",function(s){o.eBV(e);const n=o.XpG();return o.Njj(n.onYardChange(s.value))}),o.k0s()}if(2&r){const e=o.XpG();o.Y8G("dataSource",e.yardList)("fields",o.lJ4(2,_))}}function M(r,l){if(1&r&&o.nrm(0,"ejs-dropdownlist",52),2&r){const e=o.XpG();o.Y8G("dataSource",e.areaList)("fields",o.lJ4(2,b))}}function G(r,l){if(1&r&&o.nrm(0,"ejs-dropdownlist",53),2&r){const e=o.XpG();o.Y8G("dataSource",e.areaList)("fields",o.lJ4(2,b))}}function R(r,l){1&r&&o.nrm(0,"ejs-textbox",54),2&r&&o.Y8G("readonly",!0)}function Y(r,l){if(1&r){const e=o.RV6();o.j41(0,"ejs-dropdownlist",55),o.bIt("change",function(s){o.eBV(e);const n=o.XpG();return o.Njj(n.onjobDeptChange(s.value))}),o.k0s()}if(2&r){const e=o.XpG();o.Y8G("dataSource",e.jobDeptList)}}function U(r,l){1&r&&o.nrm(0,"ejs-textbox",56),2&r&&o.Y8G("readonly",!0)}function J(r,l){if(1&r){const e=o.RV6();o.j41(0,"ejs-dropdownlist",57),o.bIt("change",function(s){o.eBV(e);const n=o.XpG();return o.Njj(n.onJobTypeChange(s.value))}),o.k0s()}if(2&r){const e=o.XpG();o.Y8G("dataSource",e.jobTypeList)}}function V(r,l){1&r&&o.nrm(0,"ejs-textbox",58),2&r&&o.Y8G("readonly",!0)}function B(r,l){if(1&r){const e=o.RV6();o.j41(0,"ejs-dropdownlist",59),o.bIt("change",function(s){o.eBV(e);const n=o.XpG();return o.Njj(n.onCustomerChange(s.value))}),o.k0s()}if(2&r){const e=o.XpG();o.Y8G("dataSource",e.customerList)("fields",o.lJ4(2,D))}}function W(r,l){1&r&&o.nrm(0,"ejs-textbox",60),2&r&&o.Y8G("readonly",!0)}function $(r,l){if(1&r){const e=o.RV6();o.j41(0,"ejs-dropdownlist",61),o.bIt("change",function(s){o.eBV(e);const n=o.XpG();return o.Njj(n.onJobCodeChange(s.value))}),o.k0s()}if(2&r){const e=o.XpG();o.Y8G("dataSource",e.jobIdList)("fields",o.lJ4(2,w))}}function A(r,l){1&r&&o.nrm(0,"ejs-textbox",62),2&r&&o.Y8G("readonly",!0)}function X(r,l){if(1&r&&o.nrm(0,"ejs-dropdownlist",63),2&r){const e=o.XpG();o.Y8G("dataSource",e.wOption)}}let K=(()=>{class r{constructor(e,t,s,n){this.service=e,this.spinner=t,this.route=s,this.router=n,this.pageSettings={pageSize:10},this.editSettings={allowEditing:!1,allowAdding:!1,allowDeleting:!0,mode:"Dialog"},this.toolbar=[{text:"Checked",tooltipText:"Checked",prefixIcon:"e-icons e-check",id:"check"},"Search"],this.lines="Both",this.submitClicked=!1,this.format1="dd-MMM-yy hh:mm a",this.yardList=[],this.truckTypeList=["RG","Customer","Supplier"],this.endDate=new Date,this.isInWb=!1,this.isOutWb=!1,this.today=new Date,this.placeholder="Select One",this.filterPlaceholder="Search",this.jobDeptList=["CCA","Rail","Warehouse"],this.jobTypeList=[],this.jobIdList=[],this.customerList=[],this.proposalList=[],this.areaList=[],this.categoryList=[],this.blNoList=[],this.wOption=["None","Cash","Credit"]}ngOnInit(){this.id=this.route.snapshot.queryParams.id,this.proposalForm=new i.gE({propNo:new i.MJ(""),yard:new i.MJ("",i.k0.required),areaID:new i.MJ("",i.k0.required),estDate:new i.MJ(this.today,i.k0.required),jobDept:new i.MJ("",i.k0.required),jobType:new i.MJ("",i.k0.required),jobCode:new i.MJ("",i.k0.required),noOfTEU:new i.MJ(""),noOfFEU:new i.MJ(""),lclQty:new i.MJ(""),customerId:new i.MJ("",i.k0.required),customerName:new i.MJ(""),pcCode:new i.MJ("",i.k0.required),cargoInfo:new i.MJ(""),noOfTruck:new i.MJ("",i.k0.required),blNo:new i.MJ(""),weightOption:new i.MJ("")}),this.id&&this.getProposalList(this.id),this.getLocationList(),this.getCategoryList()}getProposalList(e){this.spinner.show(),this.service.getProposalListById(e).pipe((0,d.W)(t=>(0,p.of)(this.showError(t)))).subscribe(t=>{this.proposalForm.controls.propNo.setValue(t[0].propNo),this.proposalForm.controls.yard.setValue(t[0].yard),this.proposalForm.controls.areaID.setValue(t[0].areaID),this.proposalForm.controls.jobDept.setValue(t[0].jobDept),this.proposalForm.controls.jobType.setValue(t[0].jobType),this.proposalForm.controls.customerId.setValue(t[0].customer),this.proposalForm.controls.jobCode.setValue(t[0].jobCode),this.proposalForm.controls.blNo.setValue(t[0].blNo),this.proposalForm.controls.pcCode.setValue(t[0].pcCode),this.proposalForm.controls.weightOption.setValue(t[0].weightOption),this.proposalForm.controls.noOfTruck.setValue(t[0].noOfTruck),this.proposalForm.controls.noOfTEU.setValue(t[0].noOfTEU),this.proposalForm.controls.noOfFEU.setValue(t[0].noOfFEU),this.proposalForm.controls.lclQty.setValue(t[0].lclQty),this.proposalForm.controls.cargoInfo.setValue(t[0].cargoInfo),this.spinner.hide()})}getLocationList(){this.spinner.show(),this.service.getYardList().pipe((0,d.W)(e=>(0,p.of)(this.showError(e)))).subscribe(e=>{this.yardList=e,this.spinner.hide()})}getAreaList(e,t){this.spinner.show(),this.service.getAreaList(e,t).pipe((0,d.W)(s=>(0,p.of)(this.showError(s)))).subscribe(s=>{this.areaList=s,this.spinner.hide()})}getCategoryList(){this.spinner.show(),this.service.getCategoryList("TMS").pipe((0,d.W)(e=>(0,p.of)(this.showError(e)))).subscribe(e=>{this.categoryList=e,this.spinner.hide()})}onjobDeptChange(e){this.jDept=e,"Rail"==e?(this.jobTypeList=[],this.jobTypeList=["Pickup","Receive BC","Receive GC","Receive SC","Delivery","Issue BC","Issue GC","Issue SC"]):"Warehouse"==e?(this.jobTypeList=[],this.jobTypeList=["Inbound","Outbound"]):(this.jobTypeList=[],this.jobTypeList=["Import","Ex Bond","Export","Into Bond"])}onJobTypeChange(e){let t=this.proposalForm.value;F()(t.estDate).format("MM/DD/YYYY"),this.yard=t.yard,"Rail"==this.jDept?this.service.getRailDailyJobList(e,this.yard).pipe((0,d.W)(n=>(0,p.of)(this.showError(n)))).subscribe(n=>{this.customerList=[],this.customerList=n}):"Warehouse"==this.jDept?this.service.getWHDailyJobList(e,this.yard).pipe((0,d.W)(n=>(0,p.of)(this.showError(n)))).subscribe(n=>{this.customerList=[],this.customerList=n}):this.service.getCCADailyJobList(e,this.yard).pipe((0,d.W)(n=>(0,p.of)(this.showError(n)))).subscribe(n=>{this.customerList=[],this.customerList=n})}onCustomerChange(e){const t=this.customerList.filter(s=>s.customerId==e);this.proposalForm.controls.customerName.setValue(t[0].name),this.jobIdList=t}onJobCodeChange(e){const t=this.jobIdList.filter(s=>s.jobCode==e);this.proposalForm.controls.noOfTEU.setValue(t[0].noOfTEU),this.proposalForm.controls.noOfFEU.setValue(t[0].noOfFEU),this.proposalForm.controls.lclQty.setValue(t[0].lclQty),this.proposalForm.controls.cargoInfo.setValue(t[0].remark),this.getBLNoList(e)}getBLNoList(e){this.spinner.show(),this.service.getBLNoList(e,this.jDept).pipe((0,d.W)(t=>(0,p.of)(this.showError(t)))).subscribe(t=>{this.proposalForm.controls.blNo.setValue(t[0].blNo),this.spinner.hide()})}onFormSubmit(){this.spinner.show();const e=this.proposalForm.value;0!=e.propNo?this.updateTMSproposal(e):this.addTMSProposal(e)}addTMSProposal(e){e.propNo=0,e.createdUser=localStorage.getItem("currentUser"),this.service.addTMSProposal(e).pipe((0,d.W)(t=>(0,p.of)(this.showError(t)))).subscribe(t=>{if(1==t.status){const s=t.message;this.showSuccess(t.messageContent),this.router.navigate(["/tms-operation/proposal-detail"],{queryParams:{id:s}})}else this.spinner.hide(),c().fire("Proposal",t.messageContent,"error")})}updateTMSproposal(e){e.updatedUser=localStorage.getItem("currentUser"),this.service.updateTMSProposal(e).pipe((0,d.W)(t=>(0,p.of)(this.showError(t)))).subscribe(t=>{1==t.status?(this.showSuccess(t.messageContent),this.router.navigate(["/tms-operation/proposal"])):(this.spinner.hide(),c().fire("Proposal",t.messageContent,"error"))})}onYardChange(e){this.getAreaList(e,"TMS")}showError(e){this.spinner.hide(),c().fire("TMS Proposal",e.statusText,"error")}showSuccess(e){this.spinner.hide(),c().fire("TMS Proposal",e,"success")}validateControl(e){const t=this.proposalForm.get(e);return t.invalid&&(t.dirty||t.touched)||t.invalid&&this.submitClicked}static#o=this.\u0275fac=function(t){return new(t||r)(o.rXU(E.a),o.rXU(h.ex),o.rXU(u.nX),o.rXU(u.Ix))};static#e=this.\u0275cmp=o.VBU({type:r,selectors:[["app-proposal-form"]],viewQuery:function(t,s){if(1&t&&o.GBs(I,5),2&t){let n;o.mGM(n=o.lsd())&&(s.grid=n.first)}},standalone:!0,features:[o.aNF],decls:127,vars:42,consts:[[1,"content","mt-0"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard","routerLinkActive","active"],[1,"nav-icon","fas","fa-tachometer-alt"],[1,"breadcrumb-item","active","text-primary"],[1,"card","card-primary","card-outline"],[1,"card-body"],[3,"formGroup"],[1,"col-md-6","col-lg-6","text-left"],["class","card-title",4,"ngIf"],[1,"col-md-6","col-lg-6","text-end"],["type","submit","class","btn btn-sm btn-primary mr-2 ",3,"disabled","click",4,"ngIf"],["href","/tms-operation/proposal",1,"btn","btn-sm","btn-secondary","m-1"],[1,"fa","fa-arrow-circle-left"],[1,"form-group","col-md-4"],[1,"font-weight-normal","requiredfield"],["formControlName","yard","readonly","true","placeholder","Select One","popupHeight","200px",3,"dataSource","fields",4,"ngIf"],["formControlName","yard","tabindex","1","placeholder","Select One","popupHeight","200px",3,"dataSource","fields","change",4,"ngIf"],[1,"e-error",2,"display","block"],["formControlName","areaID","readonly","true","placeholder","Select One","popupHeight","200px",3,"dataSource","fields",4,"ngIf"],["formControlName","areaID","tabindex","2","placeholder","Select One","popupHeight","200px",3,"dataSource","fields",4,"ngIf"],["formControlName","jobDept",3,"readonly",4,"ngIf"],["formControlName","jobDept","tabindex","3","popupHeight","200px","placeholder","Select One",3,"dataSource","change",4,"ngIf"],["formControlName","jobType",3,"readonly",4,"ngIf"],["formControlName","jobType","tabindex","4",3,"dataSource","change",4,"ngIf"],[1,"form-group","col-md-8"],["formControlName","customerId",3,"readonly",4,"ngIf"],["formControlName","customerId","tabindex","5",3,"dataSource","fields","change",4,"ngIf"],["formControlName","jobCode",3,"readonly",4,"ngIf"],["formControlName","jobCode","tabindex","6",3,"dataSource","fields","change",4,"ngIf"],[1,"font-weight-normal"],["formControlName","blNo"],["formControlName","pcCode","tabindex","7","placeholder","Select One","popupHeight","200px",3,"dataSource","fields"],["formControlName","estDate","autocomplete","off","tabindex","8",3,"format"],["formControlName","weightOption",3,"readonly",4,"ngIf"],["formControlName","weightOption","tabindex","9","popupHeight","200px",3,"dataSource",4,"ngIf"],["formControlName","noOfTruck","tabindex","10"],["formControlName","noOfTEU","tabindex","11"],["formControlName","noOfFEU","tabindex","12"],["formControlName","lclQty","tabindex","13"],["formControlName","cargoInfo","tabindex","14"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","square-jelly-box",3,"fullScreen"],[2,"color","white"],[1,"card-title"],["type","submit",1,"btn","btn-sm","btn-primary","mr-2",3,"click","disabled"],[1,"fa","fa-save"],["formControlName","yard","readonly","true","placeholder","Select One","popupHeight","200px",3,"dataSource","fields"],["formControlName","yard","tabindex","1","placeholder","Select One","popupHeight","200px",3,"change","dataSource","fields"],["formControlName","areaID","readonly","true","placeholder","Select One","popupHeight","200px",3,"dataSource","fields"],["formControlName","areaID","tabindex","2","placeholder","Select One","popupHeight","200px",3,"dataSource","fields"],["formControlName","jobDept",3,"readonly"],["formControlName","jobDept","tabindex","3","popupHeight","200px","placeholder","Select One",3,"change","dataSource"],["formControlName","jobType",3,"readonly"],["formControlName","jobType","tabindex","4",3,"change","dataSource"],["formControlName","customerId",3,"readonly"],["formControlName","customerId","tabindex","5",3,"change","dataSource","fields"],["formControlName","jobCode",3,"readonly"],["formControlName","jobCode","tabindex","6",3,"change","dataSource","fields"],["formControlName","weightOption",3,"readonly"],["formControlName","weightOption","tabindex","9","popupHeight","200px",3,"dataSource"]],template:function(t,s){1&t&&(o.j41(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"ol",4)(5,"li",5)(6,"a",6),o.nrm(7,"i",7),o.EFF(8,"\xa0Dashboard"),o.k0s()(),o.j41(9,"li",5),o.EFF(10,"TMS Proposal"),o.k0s(),o.j41(11,"li",8),o.EFF(12,"TMS Proposal Form"),o.k0s()()()(),o.j41(13,"div",2)(14,"div",9)(15,"div",10)(16,"form",11)(17,"div",2)(18,"div",12),o.DNE(19,L,2,0,"h5",13)(20,P,2,0,"h5",13),o.k0s(),o.j41(21,"div",14),o.DNE(22,O,3,1,"button",15)(23,N,3,1,"button",15),o.j41(24,"a",16),o.nrm(25,"i",17),o.EFF(26," \xa0 Back "),o.k0s()()(),o.nrm(27,"br"),o.j41(28,"div",2)(29,"div",18)(30,"label",19),o.EFF(31,"Yard"),o.k0s(),o.DNE(32,S,1,3,"ejs-dropdownlist",20)(33,k,1,3,"ejs-dropdownlist",21),o.j41(34,"div")(35,"label",22),o.EFF(36,"*Yard is required"),o.k0s()()(),o.j41(37,"div",18)(38,"label",19),o.EFF(39,"Operation Area"),o.k0s(),o.DNE(40,M,1,3,"ejs-dropdownlist",23)(41,G,1,3,"ejs-dropdownlist",24),o.j41(42,"div")(43,"label",22),o.EFF(44,"*Area is required"),o.k0s()()(),o.j41(45,"div",18)(46,"label",19),o.EFF(47,"Job Department"),o.k0s(),o.DNE(48,R,1,1,"ejs-textbox",25)(49,Y,1,1,"ejs-dropdownlist",26),o.j41(50,"div")(51,"label",22),o.EFF(52,"*Job Dept is required"),o.k0s()()(),o.j41(53,"div",18)(54,"label",19),o.EFF(55,"JobType"),o.k0s(),o.DNE(56,U,1,1,"ejs-textbox",27)(57,J,1,1,"ejs-dropdownlist",28),o.j41(58,"div")(59,"label",22),o.EFF(60,"*Job Type is required"),o.k0s()()(),o.j41(61,"div",29)(62,"label",19),o.EFF(63,"Customer Id"),o.k0s(),o.DNE(64,V,1,1,"ejs-textbox",30)(65,B,1,3,"ejs-dropdownlist",31),o.j41(66,"div")(67,"label",22),o.EFF(68,"*Customer Id is required"),o.k0s()()(),o.j41(69,"div",18)(70,"label",19),o.EFF(71,"Job Code"),o.k0s(),o.DNE(72,W,1,1,"ejs-textbox",32)(73,$,1,3,"ejs-dropdownlist",33),o.j41(74,"div")(75,"label",22),o.EFF(76,"*Job Code is required"),o.k0s()()(),o.j41(77,"div",18)(78,"label",34),o.EFF(79,"BL No"),o.k0s(),o.nrm(80,"ejs-textbox",35),o.k0s(),o.j41(81,"div",18)(82,"label",19),o.EFF(83,"Category"),o.k0s(),o.nrm(84,"ejs-dropdownlist",36),o.j41(85,"div")(86,"label",22),o.EFF(87,"*Category is required"),o.k0s()()(),o.j41(88,"div",18)(89,"label",19),o.EFF(90,"Est Date"),o.k0s(),o.nrm(91,"ejs-datepicker",37),o.j41(92,"div")(93,"label",22),o.EFF(94,"*Est Date Time is required"),o.k0s()()(),o.j41(95,"div",18)(96,"label",19),o.EFF(97,"Weight Option"),o.k0s(),o.DNE(98,A,1,1,"ejs-textbox",38)(99,X,1,1,"ejs-dropdownlist",39),o.k0s(),o.j41(100,"div",18)(101,"label",19),o.EFF(102,"NoOf Truck"),o.k0s(),o.nrm(103,"ejs-numerictextbox",40),o.j41(104,"div")(105,"label",22),o.EFF(106,"*Truck is required"),o.k0s()()(),o.j41(107,"div",18)(108,"label",34),o.EFF(109,"NoOfTEU"),o.k0s(),o.nrm(110,"ejs-numerictextbox",41),o.k0s(),o.j41(111,"div",18)(112,"label",34),o.EFF(113,"NoOfFEU"),o.k0s(),o.nrm(114,"ejs-numerictextbox",42),o.k0s(),o.j41(115,"div",18)(116,"label",34),o.EFF(117,"LCL Qty"),o.k0s(),o.nrm(118,"ejs-numerictextbox",43),o.k0s(),o.j41(119,"div",18)(120,"label"),o.EFF(121,"Cargo Info"),o.k0s(),o.nrm(122,"ejs-textbox",44),o.k0s()()(),o.nrm(123,"br"),o.k0s()()()()(),o.j41(124,"ngx-spinner",45)(125,"p",46),o.EFF(126," Loading... "),o.k0s()()),2&t&&(o.R7$(16),o.Y8G("formGroup",s.proposalForm),o.R7$(3),o.Y8G("ngIf",!s.id),o.R7$(),o.Y8G("ngIf",s.id),o.R7$(2),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(9),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(),o.xc7("visibility",s.validateControl("yard")?"visible":"hidden"),o.R7$(6),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(),o.xc7("visibility",s.validateControl("areaID")?"visible":"hidden"),o.R7$(6),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(),o.xc7("visibility",s.validateControl("jobDept")?"visible":"hidden"),o.R7$(6),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(),o.xc7("visibility",s.validateControl("jobType")?"visible":"hidden"),o.R7$(6),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(),o.xc7("visibility",s.validateControl("customerId")?"visible":"hidden"),o.R7$(6),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(),o.xc7("visibility",s.validateControl("jobCode")?"visible":"hidden"),o.R7$(10),o.Y8G("dataSource",s.categoryList)("fields",o.lJ4(41,T)),o.R7$(),o.xc7("visibility",s.validateControl("pcCode")?"visible":"hidden"),o.R7$(6),o.Y8G("format",s.format1),o.R7$(),o.xc7("visibility",s.validateControl("estDate")?"visible":"hidden"),o.R7$(6),o.Y8G("ngIf",s.id),o.R7$(),o.Y8G("ngIf",!s.id),o.R7$(5),o.xc7("visibility",s.validateControl("noOfTruck")?"visible":"hidden"),o.R7$(20),o.Y8G("fullScreen",!0))},dependencies:[g.Q,v.bT,i.qT,i.BC,i.cb,i.j4,i.JD,x.V9,f.Jh,y.I,f.OV,h.et]})}return r})()}}]);