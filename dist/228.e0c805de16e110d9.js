"use strict";(self.webpackChunktms_gate=self.webpackChunktms_gate||[]).push([[228],{9228:(S,b,l)=>{l.r(b),l.d(b,{ProposalDetailComponent:()=>L});var k=l(27),r=l(9417),T=l(8032),a=l.n(T),d=l(9437),p=l(7673),e=l(3953),j=l(3542),_=l(6554),g=l(3782),u=l(8578),f=l(4088),v=l(3924),y=l(7808),D=l(6674),C=l(5029);const E=["Grid"],F=["rglModel"],M=["customerModel"],N=()=>({text:"truckNo",value:"truckNo"}),P=()=>({text:"vehicleRegNo",value:"vehicleRegNo"});function x(n,h){1&n&&(e.j41(0,"div",55),e.EFF(1,"Detail Form AssingIn"),e.k0s())}function w(n,h){if(1&n){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onAssignInSubmit())}),e.EFF(1,"Save"),e.k0s(),e.j41(2,"button",57),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(77);return e.Njj(i.hide())}),e.EFF(3,"Close"),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("disabled",!t.rglTruckForm.valid)}}function R(n,h){1&n&&(e.j41(0,"div",55),e.EFF(1,"Detail Form Customer"),e.k0s())}function I(n,h){if(1&n){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onCustomerSubmit())}),e.EFF(1,"Save"),e.k0s(),e.j41(2,"button",57),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(111);return e.Njj(i.hide())}),e.EFF(3,"Close"),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("disabled",!t.customerTruckForm.valid)}}let L=(()=>{class n{constructor(t,o,i,s){this.service=t,this.spinner=o,this.route=i,this.router=s,this.pageSettings={pageSize:50},this.editSettings={allowEditing:!1,allowAdding:!0,allowDeleting:!0},this.toolbar=[{text:"RGLTruck",tooltipText:"RGLTruck",prefixIcon:"e-icons e-circle-add",id:"rglTruck"},{text:"CustomerTruck",tooltipText:"CustomerTruck",prefixIcon:"e-icons e-circle-add",id:"customerTruck"},{text:"In Check",tooltipText:"In Check",prefixIcon:"e-icons e-circle-add",id:"check"},"Delete","ExcelExport","Search"],this.lines="Both",this.format1="dd-MMM-yy hh:mm a",this.proposalDetailForm=[],this.submitClicked=!1,this.assignList=["RGL","Supplier"],this.truckList=[],this.jobTypeList=[],this.cusTruckList=[]}ngOnInit(){this.id=this.route.snapshot.queryParams.id,this.optionForm=new r.gE({propNo:new r.MJ(""),yard:new r.MJ(""),estDate:new r.MJ(""),jobDept:new r.MJ(""),jobType:new r.MJ(""),jobCode:new r.MJ(""),areaID:new r.MJ(""),pcCode:new r.MJ("")}),this.rglTruckForm=new r.gE({propNo:new r.MJ(""),jobDept:new r.MJ(""),assignType:new r.MJ("",r.k0.required),truckNo:new r.MJ("",r.k0.required),nightStop:new r.MJ(""),otherInfo:new r.MJ(""),jobType:new r.MJ("",r.k0.required),truckAssignId:new r.MJ("")}),this.customerTruckForm=new r.gE({propNo:new r.MJ(""),jobDept:new r.MJ(""),assignType:new r.MJ("",r.k0.required),truckNo:new r.MJ("",r.k0.required),nightStop:new r.MJ(""),otherInfo:new r.MJ(""),jobType:new r.MJ("",r.k0.required)}),this.getCusTruckList(),null!=this.id&&this.loadTableData(this.id)}getCusTruckList(){this.service.getCusTruckList().pipe((0,d.W)(t=>(0,p.of)(this.showError(t)))).subscribe(t=>{this.cusTruckList=t,this.spinner.hide()})}loadTableData(t){this.service.getProposalDetailList(t).pipe((0,d.W)(o=>(0,p.of)(this.showError(o)))).subscribe(o=>{this.optionForm.controls.propNo.setValue(o.propNo),this.propNo=o.propNo,this.optionForm.controls.yard.setValue(o.yard),this.optionForm.controls.estDate.setValue(o.estDate),this.optionForm.controls.jobDept.setValue(o.jobDept),this.optionForm.controls.areaID.setValue(o.areaID),this.optionForm.controls.pcCode.setValue(o.pcCode),this.jobDept=o.jobDept,"CCA"==this.jobDept?(this.jobTypeList=[],this.jobTypeList=["Import","Export"]):"Warehouse"==this.jobDept?(this.jobTypeList=[],this.jobTypeList=["WH Pick Up","WH Delivery","Bonded Delivery","Bonded Transport","Import","Export"]):(this.jobTypeList=[],this.jobTypeList=["Rail Delivery","Rail Pick Up"]),this.optionForm.controls.jobType.setValue(o.jobType),this.optionForm.controls.jobCode.setValue(o.jobCode),this.grid.dataSource=o.proposalDetailList,this.spinner.hide()})}actionBegin(t){if("delete"===t.requestType){t.cancel=!0;const o=t.data;this.deleteProposalDetail(o[0].propNo,o[0].truckNo)}}onAssignInSubmit(){const t=this.rglTruckForm.value,o=JSON.stringify(t.truckNo);t.truckNo=o,t.createdUser=localStorage.getItem("currentUser"),this.createProposalDetail(t)}onCustomerSubmit(){const t=this.customerTruckForm.value,o=JSON.stringify(t.truckNo);t.truckNo=o,t.createdUser=localStorage.getItem("currentUser"),this.createProposalDetail(t)}createProposalDetail(t){this.spinner.show(),this.service.createProposalDetail(t).pipe((0,d.W)(o=>(0,p.of)(this.showError(o)))).subscribe(o=>{1==o.status?(this.rglModel.hide(),this.customerModel.hide(),this.showSuccess(o.messageContent),this.loadTableData(this.id)):(this.spinner.hide(),a().fire("Proposal",o.messageContent,"error"))})}deleteProposalDetail(t,o){a().fire({title:"Are you sure?",text:"You will not be able to recover this data!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",cancelButtonText:"No, keep it",confirmButtonText:"Yes, I am sure!"}).then(i=>{i.value?(this.spinner.show(),this.service.deleteProposalDetail(t,o).pipe((0,d.W)(s=>(0,p.of)(this.showError(s)))).subscribe(s=>{1==s.status?(this.showSuccess(s.messageContent),this.loadTableData(this.id)):(this.spinner.hide(),a().fire("TMS Proposal Detail",s.messageContent,"error"))})):i.dismiss===a().DismissReason.cancel&&a().close()})}onAssignTypeChange(t){null!=t&&null!=this.jobDept&&(this.type=t,"CCA"==this.jobDept?(this.jobTypeList=[],this.jobTypeList=["Import","Export"]):"Warehouse"==this.jobDept?(this.jobTypeList=[],this.jobTypeList=["WH Pick Up","WH Delivery","Bonded Delivery","Bonded Transport","Import","Export"]):(this.jobTypeList=[],this.jobTypeList=["Rail Delivery","Rail Pick Up"]))}onJobTypeChange(t){null!=this.type?null!=this.type&&null!=t&&this.service.getTruckList(this.type,t).pipe((0,d.W)(o=>(0,p.of)(this.showError(o)))).subscribe(o=>{this.truckList=o}):a().fire("Proposal","Please Select type!","warning")}toolbarClick(t){if("Excel Export"===t.item.text&&this.grid.excelExport({fileName:"ProposalDetail.xlsx"}),"rglTruck"===t.item.id||"customerTruck"===t.item.id||"check"===t.item.id){if("rglTruck"===t.item.id)return this.rglTruckForm.reset(),this.rglTruckForm.controls.propNo.setValue(this.propNo),this.rglTruckForm.controls.jobDept.setValue(this.jobDept),void this.rglModel.show();if("customerTruck"===t.item.id)return this.customerTruckForm.reset(),this.customerTruckForm.controls.assignType.setValue("Customer"),this.customerTruckForm.controls.propNo.setValue(this.propNo),this.customerTruckForm.controls.jobDept.setValue(this.jobDept),void this.customerModel.show();if("check"===t.item.id){let o=this.grid.getSelectedRecords();this.router.navigate(["/tms-operation/tms-in-check-proposal-doc"],0==o.length?{queryParams:{poNo:this.propNo,id:null,truck:null,type:null}}:{queryParams:{poNo:o[0].propNo,id:null,truck:o[0].truckNo,type:o[0].assignType}})}}}exportQueryCellInfo(t){""===t.column.headerText&&(t.hyperLink={target:t.data,displayText:t.data})}validateControl(t){const o=this.rglTruckForm.get(t);return o.invalid&&(o.dirty||o.touched)||o.invalid&&this.submitClicked}customerValidateControl(t){const o=this.customerTruckForm.get(t);return o.invalid&&(o.dirty||o.touched)||o.invalid&&this.submitClicked}showSuccess(t){this.spinner.hide(),a().fire("TMS Proposal Detail",t,"success")}showError(t){this.spinner.hide(),a().fire("TMS Proposal Detail",t.statusText,"error")}static#e=this.\u0275fac=function(o){return new(o||n)(e.rXU(j.a),e.rXU(_.ex),e.rXU(g.nX),e.rXU(g.Ix))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-proposal-detail"]],viewQuery:function(o,i){if(1&o&&(e.GBs(E,5),e.GBs(F,5),e.GBs(M,5)),2&o){let s;e.mGM(s=e.lsd())&&(i.grid=s.first),e.mGM(s=e.lsd())&&(i.rglModel=s.first),e.mGM(s=e.lsd())&&(i.customerModel=s.first)}},standalone:!0,features:[e.aNF],decls:147,vars:47,consts:[["Grid",""],["rglModel",""],["header",""],["footerTemplate",""],["customerModel",""],[1,"content","mt-0"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/","routerLinkActive","active"],[1,"nav-icon","fas","fa-tachometer-alt"],[1,"breadcrumb-item","active","text-primary"],[1,"card","card-primary","card-outline"],[1,"card-header"],[1,"col-md-6","col-lg-6","text-left"],[1,"card-title"],[1,"col-md-6","col-lg-6","text-end"],[1,"mb-2"],["href","/tms-operation/proposal",1,"btn","btn-sm","btn-secondary"],[1,"fa","fa-arrow-circle-left"],[1,"card-body"],[1,"col-md-12","col-lg-12","text"],[3,"formGroup"],[1,"row","mb-2"],[1,"col-lg-3","col-md-6"],["formControlName","propNo","tabindex","1",3,"readonly"],["formControlName","yard",3,"readonly"],["formControlName","estDate","floatLabelType","Always",3,"format","readonly"],["formControlName","jobDept",3,"readonly"],["formControlName","jobType",3,"readonly"],["formControlName","jobCode",3,"readonly"],["formControlName","areaID",3,"readonly"],["formControlName","pcCode",3,"readonly"],[3,"actionBegin","toolbarClick","allowResizing","allowSorting","allowPaging","pageSettings","editSettings","allowExcelExport","toolbar","gridLines"],["field","truckNo","headerText","Truck No","width","150"],["field","nightStop","headerText","Night Stop","width","100"],["field","truckAssignOption","headerText","TruckAssignOption","width","180"],["field","otherInfo","headerText","Other Info","width","250"],["isModal","true","height","55%","width","700px","allowDragging","true",3,"showCloseIcon","visible"],[1,"form-group","col-md-6"],[1,"requiredfield"],["formControlName","assignType","tabindex","1",3,"change","dataSource"],[1,"e-error",2,"display","block"],["formControlName","jobType","tabindex","2",3,"change","dataSource"],["formControlName","truckNo","placeholder","Truck No","floatLabelType","Always",3,"dataSource","fields"],["formControlName","otherInfo","tabindex","6"],[1,"mb-2","mt-4"],["formControlName","nightStop","label","Night Stop"],["formControlName","assignType","tabindex","1",3,"readonly"],["formControlName","jobType","tabindex","2",3,"dataSource"],["formControlName","otherInfo","tabindex","4"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","square-jelly-box",3,"fullScreen"],[2,"color","white"],[1,"font-weight-bold"],["type","submit","ejs-button","",1,"e-edit-dialog","e-control","e-btn","e-lib","e-primary","e-flat",3,"click","disabled"],["ejs-button","",1,"e-edit-dialog","e-control","e-btn","e-lib","e-flat",3,"click"]],template:function(o,i){if(1&o){const s=e.RV6();e.j41(0,"section",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"ol",9)(5,"li",10)(6,"a",11),e.nrm(7,"i",12),e.EFF(8,"\xa0Dashboard"),e.k0s()(),e.j41(9,"li",13),e.EFF(10,"TMS Proposal"),e.k0s()()()(),e.j41(11,"div",7)(12,"div",14)(13,"div",15)(14,"div",7)(15,"div",16)(16,"h5",17),e.EFF(17,"TMS Proposal Detail"),e.k0s()(),e.j41(18,"div",18)(19,"div",19)(20,"a",20),e.nrm(21,"i",21),e.EFF(22," \xa0 Back "),e.k0s()()()()(),e.j41(23,"div",22)(24,"div",7)(25,"div",23)(26,"Form",24)(27,"div",25)(28,"div",26)(29,"div",19)(30,"label"),e.EFF(31,"PropNo"),e.k0s(),e.nrm(32,"ejs-textbox",27),e.k0s()(),e.j41(33,"div",26)(34,"div",19)(35,"label"),e.EFF(36,"Yard"),e.k0s(),e.nrm(37,"ejs-textbox",28),e.k0s()(),e.j41(38,"div",26)(39,"div",19)(40,"label"),e.EFF(41,"Estimate Date"),e.k0s(),e.nrm(42,"ejs-datepicker",29),e.k0s()(),e.j41(43,"div",26)(44,"div",19)(45,"label"),e.EFF(46,"Dept Type"),e.k0s(),e.nrm(47,"ejs-textbox",30),e.k0s()(),e.j41(48,"div",26)(49,"div",19)(50,"label"),e.EFF(51,"Job Type"),e.k0s(),e.nrm(52,"ejs-textbox",31),e.k0s()(),e.j41(53,"div",26)(54,"div",19)(55,"label"),e.EFF(56,"Job Code"),e.k0s(),e.nrm(57,"ejs-textbox",32),e.k0s()(),e.j41(58,"div",26)(59,"div",19)(60,"label"),e.EFF(61,"Operation Area"),e.k0s(),e.nrm(62,"ejs-textbox",33),e.k0s()(),e.j41(63,"div",26)(64,"div",19)(65,"label"),e.EFF(66,"Category"),e.k0s(),e.nrm(67,"ejs-textbox",34),e.k0s()()()()()(),e.nrm(68,"br"),e.j41(69,"ejs-grid",35,0),e.bIt("actionBegin",function(c){return e.eBV(s),e.Njj(i.actionBegin(c))})("toolbarClick",function(c){return e.eBV(s),e.Njj(i.toolbarClick(c))}),e.j41(71,"e-columns"),e.nrm(72,"e-column",36)(73,"e-column",37)(74,"e-column",38)(75,"e-column",39),e.k0s()()()()()(),e.j41(76,"ejs-dialog",40,1),e.DNE(78,x,2,0,"ng-template",null,2,e.C5r),e.j41(80,"form",24)(81,"div",7)(82,"div",41)(83,"label",42),e.EFF(84,"Assign Type"),e.k0s(),e.j41(85,"ejs-dropdownlist",43),e.bIt("change",function(c){return e.eBV(s),e.Njj(i.onAssignTypeChange(c.value))}),e.k0s(),e.j41(86,"div")(87,"label",44),e.EFF(88,"*Assign Type is required"),e.k0s()()(),e.j41(89,"div",41)(90,"label",42),e.EFF(91,"Job Type"),e.k0s(),e.j41(92,"ejs-dropdownlist",45),e.bIt("change",function(c){return e.eBV(s),e.Njj(i.onJobTypeChange(c.value))}),e.k0s(),e.j41(93,"div")(94,"label",44),e.EFF(95,"*Jobtype is required"),e.k0s()()(),e.j41(96,"div",41),e.nrm(97,"ejs-multiselect",46),e.j41(98,"div")(99,"label",44),e.EFF(100,"*Truck No is required"),e.k0s()()(),e.j41(101,"div",41)(102,"label"),e.EFF(103,"OtherInfo"),e.k0s(),e.nrm(104,"ejs-textbox",47),e.k0s(),e.j41(105,"div",41)(106,"div",48),e.nrm(107,"ejs-checkbox",49),e.k0s()()(),e.DNE(108,w,4,1,"ng-template",null,3,e.C5r),e.k0s()(),e.j41(110,"ejs-dialog",40,4),e.DNE(112,R,2,0,"ng-template",null,2,e.C5r),e.j41(114,"form",24)(115,"div",7)(116,"div",41)(117,"label",42),e.EFF(118,"Assign Type"),e.k0s(),e.nrm(119,"ejs-textbox",50),e.j41(120,"div")(121,"label",44),e.EFF(122,"*Assign Type is required"),e.k0s()()(),e.j41(123,"div",41)(124,"label",42),e.EFF(125,"Job Type"),e.k0s(),e.nrm(126,"ejs-dropdownlist",51),e.j41(127,"div")(128,"label",44),e.EFF(129,"*Jobtype is required"),e.k0s()()(),e.j41(130,"div",41),e.nrm(131,"ejs-multiselect",46),e.j41(132,"div")(133,"label",44),e.EFF(134,"*Truck No is required"),e.k0s()()(),e.j41(135,"div",41)(136,"label"),e.EFF(137,"OtherInfo"),e.k0s(),e.nrm(138,"ejs-textbox",52),e.k0s(),e.j41(139,"div",41)(140,"div",48),e.nrm(141,"ejs-checkbox",49),e.k0s()()(),e.DNE(142,I,4,1,"ng-template",null,3,e.C5r),e.k0s()()(),e.j41(144,"ngx-spinner",53)(145,"p",54),e.EFF(146," Loading... "),e.k0s()()}2&o&&(e.R7$(26),e.Y8G("formGroup",i.optionForm),e.R7$(6),e.Y8G("readonly",!0),e.R7$(5),e.Y8G("readonly",!0),e.R7$(5),e.Y8G("format",i.format1)("readonly",!0),e.R7$(5),e.Y8G("readonly",!0),e.R7$(5),e.Y8G("readonly",!0),e.R7$(5),e.Y8G("readonly",!0),e.R7$(5),e.Y8G("readonly",!0),e.R7$(5),e.Y8G("readonly",!0),e.R7$(2),e.Y8G("allowResizing",!0)("allowSorting",!0)("allowPaging",!0)("pageSettings",i.pageSettings)("editSettings",i.editSettings)("allowExcelExport",!0)("toolbar",i.toolbar)("gridLines",i.lines),e.R7$(7),e.Y8G("showCloseIcon",!0)("visible",!1),e.R7$(4),e.Y8G("formGroup",i.rglTruckForm),e.R7$(5),e.Y8G("dataSource",i.assignList),e.R7$(),e.xc7("visibility",i.validateControl("assignType")?"visible":"hidden"),e.R7$(6),e.Y8G("dataSource",i.jobTypeList),e.R7$(),e.xc7("visibility",i.validateControl("jobType")?"visible":"hidden"),e.R7$(4),e.Y8G("dataSource",i.truckList)("fields",e.lJ4(45,N)),e.R7$(),e.xc7("visibility",i.validateControl("truckNo")?"visible":"hidden"),e.R7$(12),e.Y8G("showCloseIcon",!0)("visible",!1),e.R7$(4),e.Y8G("formGroup",i.customerTruckForm),e.R7$(5),e.Y8G("readonly",!0),e.R7$(),e.xc7("visibility",i.customerValidateControl("assignType")?"visible":"hidden"),e.R7$(6),e.Y8G("dataSource",i.jobTypeList),e.R7$(),e.xc7("visibility",i.validateControl("jobType")?"visible":"hidden"),e.R7$(4),e.Y8G("dataSource",i.cusTruckList)("fields",e.lJ4(46,P)),e.R7$(),e.xc7("visibility",i.validateControl("truckNo")?"visible":"hidden"),e.R7$(12),e.Y8G("fullScreen",!0))},dependencies:[k.Q,r.qT,r.BC,r.cb,r.j4,r.JD,u._ab,u.eeu,u.rFS,u.LGG,u.cvh,f.V9,v.I,y.OV,D.mq,f.b3,C.$W,_.et]})}return n})()}}]);